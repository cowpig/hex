<!DOCTYPE html>  
<meta charset="utf-8" />  
<title>WebSocket Test</title>  
<script type="text/javascript" src="js/HexagonTools.js"></script>
<script language="javascript" type="text/javascript">

	var wsUri = "ws://localhost:8000/ws";
	var websocket = new WebSocket(wsUri);
	var statusBar;
	function init() { 
		statusBar = document.getElementById("statusDiv");
		if (!'WebSocket' in window){
			writeToScreen('<span style="color: red;">ERROR: Update your browser to one that supports websockets. A list can be found <a href="http://caniuse.com/websockets">here</a></span>');
		} else {
			testWebSocket();
		}
	}
	function onOpen(evt) { 
		writeToScreen("CONNECTED");
	}
	function onClose(evt) { 
		writeToScreen("DISCONNECTED");
	}
	function onMessage(evt) {
		console.log("new data recieved");
		if (evt.data[0] == "[") {
			drawHexGrid(evt.data, 20, 20, 40, 40);
		} else {
			writeToScreen("Error: " + evt.data);
		}
	}
	function onError(evt) { 
		writeToScreen('<span style="color: red;">ERROR:</span> ' + evt.data);
	}
	function testWebSocket() {
		websocket.onopen = function(evt) { onOpen(evt) };
		websocket.onclose = function(evt) { onClose(evt) };
		websocket.onmessage = function(evt) { onMessage(evt) };
		websocket.onerror = function(evt) { onError(evt) };
		document.getElementById("send").onclick = function () {
			websocket.send(document.getElementById("inputTxt").value);
			console.log("click registered.");
		};

	}
	function writeToScreen(message) { 
		statusBar.innerHTML = message;
	}
	window.addEventListener("load", init, false);
</script>  
</div>
<h2>WebSocket Test</h2> 
<div id="statusDiv">
</div>
<br>
<div id="inputDiv">
	<textarea id="inputTxt" cols="80" rows="10"></textarea>
	<br>
	<button id="send">send instructions</button>
</div>
<div id="canvasDiv">
	<center>
	<canvas id="hexCanvas" width="900" height="900" style="width:900px;height:900px" />
	</center>
</div>
</html>